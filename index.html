---
layout: default
---

  <div data-alert id="didyoumean" class="row hide">
  </div>

  <div class="row results-row">
    <div class="large-4 columns">
      <div class="panel radius">
        <svg class="left" xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
          <path d="M38.796 14.828l-14.89-3.988L21.3 1.116C21.082.304 20.212-.17 19.356.06L1.206 4.922C.35 5.15-.166 5.996.05 6.808l6.458 24.104c.218.812 1.088 1.286 1.942 1.056l7.226-1.936-.986 3.676c-.218.814.298 1.658 1.154 1.888l16.22 4.346c.856.228 1.726-.244 1.944-1.056l5.942-22.172c.218-.812-.298-1.658-1.154-1.886zM3.268 7.264l15.658-4.192 5.798 21.636L9.064 28.9 3.268 7.264zm28.09 29.666l-13.63-3.728 1.072-4.006 7.802-2.09c.856-.23 1.374-1.074 1.156-1.888l-3.016-11.254 11.892 3.262-5.276 19.704z" fill="#2571a1"/>
        </svg><p><strong>Database list</strong></p>
        <div class="results-list" id="dbs">
        </div>        			
      </div>
    </div>
    
    <div class="large-4 columns">
      <div class="panel radius">
        <svg class="left" xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
          <path d="M32 2H8C5.8 2 4 3.8 4 6v28c0 2.2 1.8 4 4 4h24c2.202 0 4-1.8 4-4V6c0-2.2-1.798-4-4-4zm0 32H8V6h24v28zM22 24H12v2h10v-2zm6-8h-8v2h8v-2zm-8-2h8v-4h-8v4zm-2-4h-6v8h6v-8zm-2 10h-4v2h4v-2zm2 2h10v-2H18v2zm10 6H12v2h16v-2zm-4-2h4v-2h-4v2z" fill="#2571a1"/>
        </svg>
        <p><strong>Online Journals list</strong></p>
        <div class="results-list" id="sfx">
        </div>
      </div>
    </div>

    <div class="large-4 columns">
      <div class="panel radius">
        <svg class="left" xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
          <path d="M33.296 10.286L15.3 1.008C12.834-.29 7.974 2.218 6.578 4.426 5.956 5.414 6 6.126 6 6.53l.222 20.95c.014.446.576 1.044 1.054 1.34.998.612 16.12 10.05 16.546 10.318.23.144.504.21.772.21.228 0 .458-.05.666-.154.456-.224.74-.656.74-1.13V16.062c0-.458-.268-.88-.704-1.11L8.94 5.82c.184-.36.912-1.12 2.25-1.82 1.41-.74 2.464-.46 2.706-.366 0 0 15.7 8.402 16.18 8.652.478.25.488.288.488.714v20.88c0 1.042 1.056 1.468 1.834 1.468.774 0 1.602-.76 1.602-1.468V11.396c0-.458-.27-.882-.704-1.11z" fill="#2571a1"/>
        </svg>
        <p><strong>Books and Journals</strong></p>
        <div class="results-list" id="millennium">
        </div>
      </div>
    </div>
  </div>

  <div class="row results-row">
    <div class="large-4 columns">
      <div class="panel radius">
        <svg class="left" xmlns="http://www.w3.org/2000/svg" width="40.5" height="41.167" viewBox="0 0 40.5 41.167">
          <path fill="#231F1F" d="M2.712 3.182v24.336s9.355-1.09 9.355 8.05V12.536c.002-8.702-9.355-9.354-9.355-9.354"/><path fill="#aaa" d="M7.095 1.472v21.413s5.166.997 5.166 10.134c0 9.138.026-17.002.026-21.897 0-8.702-5.19-9.65-5.19-9.65"/><path fill="#3978AD" d="M12.427 12.318v22.146s4.49-12.582 23.374 3.627c0-5.873.038-20.688.038-25.584-18.665-13.597-23.41-.188-23.41-.188"/><path fill="#fff" d="M14.207 28.896h4.184l1.353-9.314h.043l3.714 9.314h1.674l3.884-9.314h.043l1.18 9.314h4.21L32.04 12.72h-4.184l-3.477 8.644-3.285-8.644h-4.14z"/>
        </svg>
        <p><strong>PubMed@UCSF</strong></p>
        <div class="results-list" id="pubmed">
        </div>       			
      </div>
    </div>

    <div class="large-4 columns">
      <div class="panel radius">
        <svg class="left" xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
          <path d="M27.296 14.726c-.264-.71 7.08-7.27 2.796-12.584C29.088.9 25.69 8.094 20.862 11.35 18.2 13.146 12 16.97 12 19.084v13.682C12 35.308 21.828 38 29.298 38 32.036 38 36 20.85 36 18.124c0-2.734-8.44-2.686-8.704-3.398zM10 14.916c-1.314 0-6 .8-6 6.244v9.696c0 5.444 4.686 6.042 6 6.042s-2-1.144-2-4.518V19.634c0-3.536 3.314-4.718 2-4.718z" fill="#2571a1"/>
        </svg>
        <p><strong>Best Bets</strong></p>
        <div class="results-list" id="libguides">
        </div>       			
      </div>
    </div>

    <div class="large-4 columns">
      <div class="panel radius">
        <svg class="left" xmlns="http://www.w3.org/2000/svg" width="38.5" height="40.025" viewBox="0 0 38.5 40.025">
          <path fill="#2571A1" d="M20.605 26.545V5.768c.977-1.824 1.824-2.345 2.8-2.996v20.452c-1.367.977-2.605 2.54-2.8 3.32zM22.3 27.65c-.197-.193-.522-.325-.717-.453.326-.65 1.172-2.084 2.605-2.93l.39-.198V6.16c.717-1.043 2.28-1.434 3.062-1.5v20.192c-2.67.39-4.56 2.02-5.34 2.8zm1.822 3.193c-.065-1.432-.716-2.083-.78-2.215.586-.65 2.018-1.954 4.688-2.214l.65-.065V7.852c.587-.13 1.303-.326 2.67.455v9.966h1.433V7.527s-2.28-1.693-4.104-1.107V3.163l-.783.065c-.13 0-1.954.195-3.452 1.433V.754l-1.042.586c-.13.064-2.41 1.302-3.778 3.907v22.927c1.432.064 3.06 1.237 3.19 2.734h1.304l.002-.065z"/>
          <g fill="#2571A1"><path d="M1 29.085h1.824v1.822H1zM18.195 33.188h1.824v1.825h-1.825zM5.3 33.188h1.824v1.825H5.3zM1 33.188h1.824v1.825H1zM13.896 33.188h1.825v1.825h-1.824zM9.598 33.188h1.824v1.825H9.598zM31.22 33.188h1.825v1.825H31.22zM22.625 33.188h1.824v1.825h-1.825zM26.922 33.188h1.825v1.825h-1.825zM26.922 29.15h1.825v1.824h-1.825zM1 24.917h1.824v1.823H1zM35.455 29.085h1.824v1.822h-1.825zM35.455 33.188h1.824v1.825h-1.825zM18.195 37.42h1.824v1.827h-1.825zM5.3 37.42h1.824v1.827H5.3zM1 37.42h1.824v1.827H1zM13.896 37.42h1.825v1.827h-1.824zM9.598 37.42h1.824v1.827H9.598zM31.22 37.42h1.825v1.827H31.22zM22.625 37.42h1.824v1.827h-1.825zM26.922 37.42h1.825v1.827h-1.825zM35.455 20.684h1.824v1.823h-1.825zM35.455 24.917h1.824v1.823h-1.825zM35.455 16.32h1.824v1.823h-1.825zM31.156 20.684h1.824v1.823h-1.824zM31.156 29.085h1.824v1.822h-1.824zM31.22 24.917h1.825v1.823H31.22z"/></g>
          <path fill="#2571A1" d="M14.744 30.713H5.3V7.72c1.628-.846 2.8-.65 3.386-.39v20.192l.782.064c2.996.196 4.885 1.693 5.666 2.476-.13.13-.26.392-.39.65zm1.497-1.953c-.976-.912-3.256-2.605-6.252-2.996V3.36c1.954.26 3.582 2.213 3.582 2.213v19.214l.522.26c1.563.912 2.54 2.41 2.996 3.192-.26.13-.587.324-.847.52zm2.216-1.303c-.39-.783-2.15-2.67-3.778-3.713V.624c1.042.846 3.256 3.58 3.778 5.47v21.363z"/>
        </svg>
        <p><strong>News &amp; Services</strong></p>
        <div class="results-list" id="drupal6">
        </div>
      </div>
    </div>
  </div>

  <!-- if IE8 or less, give up and redirect to legacy QuickSearch -->
  <!--[if lt IE 9]>
    <script>
      window.location = 'http://www.library.ucsf.edu/quicksearch/' + encodeURIComponent(decodeURIComponent(window.location.hash.substring(1)));
    </script>
  <![endif]-->

  <script src="js/vendor/jquery.js"></script>
  <script src="js/foundation.min.js"></script>
  
  <!-- If IE9 or less, fix their broken XHR/CORS implementation -->
  <!--[if IE]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-ajaxtransport-xdomainrequest/1.0.2/jquery.xdomainrequest.min.js"></script>
  <![endif]-->
  <script>
    $(document).foundation();
  </script>

  <script>
  $(document).ready(function () {
    var showSuggestedTerms = function (suggestedTerms) {
      if (suggestedTerms) {
        var termsLink = $('<a>')
          .attr('href', '#' + suggestedTerms);
        termsLink.append(
          $('<em>')
            .text(suggestedTerms)
        );

        var didyoumean = $('#didyoumean').show();
        var alertBox = $('<div>')
          .addClass('alert-box')
          .addClass('info');
        var span = $('<span>')
          .append('Did you mean ')
          .append(termsLink)
          .append('?');
        alertBox.append(span);
        didyoumean.append(alertBox);
      }
    };

    var success = function (results) {
      var urlRegExp = /^(https?:)?\/\/[\w:\/\?&%=\.\-~\+]+$/;
      var elem = $('#' + results.name);
      if (elem.length) {
        elem.empty();
        var ol = $('<ol>');
        var li;
        var a;
        var text;

        var l = results.data.length;
        if (l) {
          for (var i=0; i<l; i++) {
            if (typeof results.data[i].url === "string" && results.data[i].url.match(urlRegExp)) {
              li = $('<li>');
              a = $('<a>')
                .attr('href', results.data[i].url)
                .text(results.data[i].name);
              li.append(a);
              ol.append(li);
            } else {
              if (window.console && window.console.log) {
                window.console.log('Bad URL: ' + results.data[i].url);
              }
            } 
          }
          elem.append(ol);
          if (results.name !== "drupal6" && typeof results.url === "string" && results.url.match(urlRegExp)) {
            elem.append($('<a>').attr('href', results.url).text('All Results'));
          }
        } else {
          elem.text('No results found.');
        }
      }

      if (results.name === "pubmed" && results.suggestedTerms instanceof Array) {
        showSuggestedTerms(results.suggestedTerms[0]); 
      }
    }
    
    var failure = function (error) {
      if (console && error.message) {
        console.log(error.message);
      }
    };
    
    var runSearch = function (event) {
      $('#didyoumean').empty().hide();
      $('.results-list').each(function (index, elem) {
        elem.innerHTML = '<progress>Loading&hellip;</progress>';
      });
      var terms = this.querySelector('.search-terms').value;
      window.location.hash = encodeURIComponent(terms);
      if (typeof EventSource !== "undefined") {
        // asynchronous updates, woo hoo!
        UCSF.Library.search({q: terms.toLowerCase(), async: true}, success, failure);
      } else {
        // no server-sent events, so six separate AJAX calls, boo!
        var cols = ['dbs', 'sfx', 'millennium', 'pubmed', 'libguides', 'drupal6'];
        for (var i=0, l=cols.length; i<l; i++) {
          $.getJSON( 'http://apis.ucsf.edu/library/search', {q: terms, c:[cols[i]]}, function (col) {
            success(col[0]);
          })
            .fail(failure);
        }
      }
    };

    $('.search-form').each(function (index, elem) {
      elem.onsubmit = function (event) {
        event.preventDefault ? event.preventDefault() : event.returnValue = false;
        var terms = this.querySelector('.search-terms').value;
        window.location.hash = encodeURIComponent(terms);
      }
    });

    var runSearchWithHashValue = function () {
      document.querySelector('.search-terms').value = decodeURIComponent(window.location.hash.substring(1));
      runSearch.call(document, document);
    }

    if (window.location.hash) {
      $('title').text('UCSF Library Search: ' + decodeURIComponent(window.location.hash.substring(1)));
      runSearchWithHashValue()
    }

    var hashChangeHandler = function () {
      $('title').text('UCSF Library Search: ' + decodeURIComponent(window.location.hash.substring(1)));
      ga('send', 'pageview');
      runSearchWithHashValue();
    };

    $(window).bind('hashchange', hashChangeHandler);
  });
  </script>
