---
layout: default
---

  <div data-alert id="didyoumean" class="row hide">
  </div>

  <div class="row results-row">
    <div class="large-4 columns">
      <div class="panel radius">
        <svg class="left" xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
          <path fill="#2571A1" d="M35.977 15.604l-12.656-3.39-2.214-8.265c-.186-.69-.925-1.094-1.653-.9L4.025 7.185c-.727.194-1.166.913-.983 1.603l5.49 20.488c.185.69.924 1.094 1.65.897l6.142-1.646-.838 3.125c-.185.692.253 1.41.98 1.605l13.788 3.694c.728.192 1.467-.208 1.65-.9l5.053-18.845c.186-.688-.252-1.407-.98-1.6zm-30.2-6.43l13.31-3.562 4.928 18.39-13.31 3.563-4.927-18.39zm23.877 25.217L18.07 31.224l.91-3.406 6.63-1.776c.73-.194 1.17-.91.983-1.603L24.03 14.87l10.108 2.774-4.484 16.747z"/>
        </svg><p><strong>Database list</strong></p>
        <div class="results-list" id="dbs">
        </div>        			
      </div>
    </div>
    
    <div class="large-4 columns">
      <div class="panel radius">
        <svg class="left" xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
          <path d="M32 2H8C5.8 2 4 3.8 4 6v28c0 2.2 1.8 4 4 4h24c2.202 0 4-1.8 4-4V6c0-2.2-1.798-4-4-4zm0 32H8V6h24v28zM22 24H12v2h10v-2zm6-8h-8v2h8v-2zm-8-2h8v-4h-8v4zm-2-4h-6v8h6v-8zm-2 10h-4v2h4v-2zm2 2h10v-2H18v2zm10 6H12v2h16v-2zm-4-2h4v-2h-4v2z" fill="#2571a1"/>
        </svg>
        <p><strong>Online Journals list</strong></p>
        <div class="results-list" id="sfx">
        </div>
      </div>
    </div>

    <div class="large-4 columns">
      <div class="panel radius">
        <svg class="left" xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
          <path d="M33.296 10.286L15.3 1.008C12.834-.29 7.974 2.218 6.578 4.426 5.956 5.414 6 6.126 6 6.53l.222 20.95c.014.446.576 1.044 1.054 1.34.998.612 16.12 10.05 16.546 10.318.23.144.504.21.772.21.228 0 .458-.05.666-.154.456-.224.74-.656.74-1.13V16.062c0-.458-.268-.88-.704-1.11L8.94 5.82c.184-.36.912-1.12 2.25-1.82 1.41-.74 2.464-.46 2.706-.366 0 0 15.7 8.402 16.18 8.652.478.25.488.288.488.714v20.88c0 1.042 1.056 1.468 1.834 1.468.774 0 1.602-.76 1.602-1.468V11.396c0-.458-.27-.882-.704-1.11z" fill="#2571a1"/>
        </svg>
        <p><strong>Books and Journals</strong></p>
        <div class="results-list" id="millennium">
        </div>
      </div>
    </div>
  </div>

  <div class="row results-row">
    <div class="large-4 columns">
      <div class="panel radius">
        <svg class="left" xmlns="http://www.w3.org/2000/svg" width="40.5" height="41.167" viewBox="0 0 40.5 41.167">
          <path fill="#231F1F" d="M2.712 3.182v24.336s9.355-1.09 9.355 8.05V12.536c.002-8.702-9.355-9.354-9.355-9.354"/><path fill="#aaa" d="M7.095 1.472v21.413s5.166.997 5.166 10.134c0 9.138.026-17.002.026-21.897 0-8.702-5.19-9.65-5.19-9.65"/><path fill="#3978AD" d="M12.427 12.318v22.146s4.49-12.582 23.374 3.627c0-5.873.038-20.688.038-25.584-18.665-13.597-23.41-.188-23.41-.188"/><path fill="#fff" d="M14.207 28.896h4.184l1.353-9.314h.043l3.714 9.314h1.674l3.884-9.314h.043l1.18 9.314h4.21L32.04 12.72h-4.184l-3.477 8.644-3.285-8.644h-4.14z"/>
        </svg>
        <p><strong>PubMed@UCSF</strong></p>
        <div class="results-list" id="pubmed">
        </div>       			
      </div>
    </div>

    <div class="large-4 columns">
      <div class="panel radius">
        <svg class="left" xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
          <path d="M27.296 14.726c-.264-.71 7.08-7.27 2.796-12.584C29.088.9 25.69 8.094 20.862 11.35 18.2 13.146 12 16.97 12 19.084v13.682C12 35.308 21.828 38 29.298 38 32.036 38 36 20.85 36 18.124c0-2.734-8.44-2.686-8.704-3.398zM10 14.916c-1.314 0-6 .8-6 6.244v9.696c0 5.444 4.686 6.042 6 6.042s-2-1.144-2-4.518V19.634c0-3.536 3.314-4.718 2-4.718z" fill="#2571a1"/>
        </svg>
        <p><strong>Best Bets</strong></p>
        <div class="results-list" id="libguides">
        </div>       			
      </div>
    </div>

    <div class="large-4 columns">
      <div class="panel radius">
        <svg class="left" xmlns="http://www.w3.org/2000/svg" width="40" height="40.025" viewBox="-592.25 416.512 40 40.025" enable-background="new -592.25 416.512 40 40.025">
          <path fill="#2571A1" d="M-570.79 441.843v-18.7c.878-1.64 1.64-2.11 2.52-2.694v18.405c-1.23.878-2.346 2.285-2.52 2.988zm1.523.996c-.176-.176-.47-.294-.644-.41.292-.586 1.054-1.875 2.343-2.638l.353-.178v-16.12c.645-.937 2.05-1.288 2.755-1.347v18.172c-2.404.35-4.104 1.816-4.807 2.52zm1.64 2.87c-.058-1.287-.644-1.873-.702-1.992.53-.586 1.817-1.76 4.22-1.992l.588-.06V425.02c.527-.117 1.17-.293 2.403.41v8.97h1.29v-9.673s-2.052-1.524-3.693-.997v-2.93l-.705.06c-.116 0-1.758.174-3.106 1.288v-3.518l-.94.527c-.115.06-2.167 1.174-3.398 3.518v20.635c1.29.058 2.754 1.113 2.872 2.46h1.172l.002-.06z"/><g fill="#2571A1"><path d="M-588.436 444.13h1.642v1.64h-1.642zM-572.96 447.822h1.642v1.643h-1.642zM-584.566 447.822h1.642v1.643h-1.642zM-588.436 447.822h1.642v1.643h-1.642zM-576.83 447.822h1.643v1.643h-1.643zM-580.698 447.822h1.642v1.643h-1.642zM-561.237 447.822h1.642v1.643h-1.642zM-568.974 447.822h1.642v1.643h-1.642zM-565.106 447.822h1.643v1.643h-1.643zM-565.106 444.188h1.643v1.64h-1.643zM-588.436 440.378h1.642v1.64h-1.642zM-557.426 444.13h1.642v1.64h-1.642zM-557.426 447.822h1.642v1.643h-1.642zM-572.96 451.632h1.642v1.643h-1.642zM-584.566 451.632h1.642v1.643h-1.642zM-588.436 451.632h1.642v1.643h-1.642zM-576.83 451.632h1.643v1.643h-1.643zM-580.698 451.632h1.642v1.643h-1.642zM-561.237 451.632h1.642v1.643h-1.642zM-568.974 451.632h1.642v1.643h-1.642zM-565.106 451.632h1.643v1.643h-1.643zM-557.426 436.57h1.642v1.638h-1.642zM-557.426 440.378h1.642v1.64h-1.642zM-557.426 432.64h1.642v1.642h-1.642zM-561.295 436.57h1.642v1.638h-1.642zM-561.295 444.13h1.642v1.64h-1.642zM-561.237 440.378h1.642v1.64h-1.642z"/></g><path fill="#2571A1" d="M-576.066 445.594h-8.5V424.9c1.465-.76 2.52-.585 3.047-.35v18.172l.705.058c2.696.176 4.397 1.523 5.1 2.23-.118.116-.235.35-.35.584zm1.347-1.757c-.878-.82-2.93-2.345-5.627-2.696v-20.164c1.758.234 3.224 1.992 3.224 1.992v17.293l.47.235c1.407.82 2.286 2.17 2.696 2.873-.234.117-.528.293-.762.47zm1.994-1.173c-.35-.705-1.934-2.403-3.4-3.342v-20.81c.938.763 2.93 3.225 3.4 4.924v19.228z"/>
        </svg>
        <p><strong>News &amp; Services</strong></p>
        <div class="results-list" id="drupal6">
        </div>
      </div>
    </div>
  </div>

  <!-- if IE8 or less, give up and redirect to legacy QuickSearch -->
  <!--[if lt IE 9]>
    <script>
      window.location = 'http://www.library.ucsf.edu/quicksearch/' + encodeURIComponent(decodeURIComponent(window.location.hash.substring(1)));
    </script>
  <![endif]-->

  <script src="js/vendor/jquery.js"></script>
  <script src="js/foundation.min.js"></script>
  
  <!-- If IE9 or less, fix their broken XHR/CORS implementation -->
  <!--[if IE]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-ajaxtransport-xdomainrequest/1.0.2/jquery.xdomainrequest.min.js"></script>
  <![endif]-->
  <script>
    $(document).foundation();
  </script>

  <script>
  $(document).ready(function () {
    var showSuggestedTerms = function (suggestedTerms) {
      if (suggestedTerms) {
        var termsLink = $('<a>')
          .attr('href', '#' + suggestedTerms);
        termsLink.append(
          $('<em>')
            .text(suggestedTerms)
        );

        var didyoumean = $('#didyoumean').show();
        var alertBox = $('<div>')
          .addClass('alert-box')
          .addClass('info');
        var span = $('<span>')
          .append('Did you mean ')
          .append(termsLink)
          .append('?');
        alertBox.append(span);
        didyoumean.append(alertBox);
      }
    };

    var success = function (results) {
      var urlRegExp = /^(https?:)?\/\/[\w:\/\?&%=\.\-~\+]+$/;
      var elem = $('#' + results.name);
      if (elem.length) {
        elem.empty();
        var ol = $('<ol>');
        var li;
        var a;
        var text;

        var l = results.data.length;
        if (l) {
          for (var i=0; i<l; i++) {
            if (typeof results.data[i].url === "string" && results.data[i].url.match(urlRegExp)) {
              li = $('<li>');
              a = $('<a>')
                .attr('href', results.data[i].url)
                .text(results.data[i].name);
              li.append(a);
              ol.append(li);
            } else {
              if (window.console && window.console.log) {
                window.console.log('Bad URL: ' + results.data[i].url);
              }
            } 
          }
          elem.append(ol);
          if (results.name !== "drupal6" && typeof results.url === "string" && results.url.match(urlRegExp)) {
            elem.append($('<a>').attr('href', results.url).text('All Results'));
          }
        } else {
          elem.text('No results found.');
        }
      }

      if (results.name === "pubmed" && results.suggestedTerms instanceof Array) {
        showSuggestedTerms(results.suggestedTerms[0]); 
      }
    }
    
    var failure = function (error) {
      if (console && error.message) {
        console.log(error.message);
      }
    };
    
    var runSearch = function (event) {
      $('#didyoumean').empty().hide();
      $('.results-list').each(function (index, elem) {
        elem.innerHTML = '<progress>Loading&hellip;</progress>';
      });
      var terms = this.querySelector('.search-terms').value;
      window.location.hash = encodeURIComponent(terms);
      if (typeof EventSource !== "undefined") {
        // asynchronous updates, woo hoo!
        UCSF.Library.search({q: terms.toLowerCase(), async: true}, success, failure);
      } else {
        // no server-sent events, so six separate AJAX calls, boo!
        var cols = ['dbs', 'sfx', 'millennium', 'pubmed', 'libguides', 'drupal6'];
        for (var i=0, l=cols.length; i<l; i++) {
          $.getJSON( 'http://apis.ucsf.edu/library/search', {q: terms, c:[cols[i]]}, function (col) {
            success(col[0]);
          })
            .fail(failure);
        }
      }
    };

    $('.search-form').each(function (index, elem) {
      elem.onsubmit = function (event) {
        event.preventDefault ? event.preventDefault() : event.returnValue = false;
        var terms = this.querySelector('.search-terms').value;
        window.location.hash = encodeURIComponent(terms);
      }
    });

    var runSearchWithHashValue = function () {
      document.querySelector('.search-terms').value = decodeURIComponent(window.location.hash.substring(1));
      runSearch.call(document, document);
    }

    if (window.location.hash) {
      $('title').text('UCSF Library Search: ' + decodeURIComponent(window.location.hash.substring(1)));
      runSearchWithHashValue()
    }

    var hashChangeHandler = function () {
      $('title').text('UCSF Library Search: ' + decodeURIComponent(window.location.hash.substring(1)));
      ga('send', 'pageview');
      runSearchWithHashValue();
    };

    $(window).bind('hashchange', hashChangeHandler);
  });
  </script>
